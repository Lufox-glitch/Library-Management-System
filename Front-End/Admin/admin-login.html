<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - Library Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            padding: 40px;
            width: 100%;
            max-width: 400px;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            font-size: 32px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .logo p {
            color: #999;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .alert {
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
            font-size: 14px;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .alert.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }

        .links {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }

        .links a {
            color: #667eea;
            text-decoration: none;
            margin: 0 10px;
        }

        .links a:hover {
            text-decoration: underline;
        }

        .divider {
            text-align: center;
            color: #999;
            margin: 20px 0;
            font-size: 12px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-size: 13px;
            color: #1565c0;
            line-height: 1.5;
        }

        .loading {
            display: none;
            text-align: center;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }

            .logo h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <h1>üîê Admin</h1>
            <p>Library Management System</p>
        </div>

        <div id="alert" class="alert"></div>

        <form onsubmit="handleLogin(event)">
            <div class="form-group">
                <label for="email">Admin Email</label>
                <input type="email" id="email" placeholder="Enter your email" required>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password" required>
            </div>

            <button type="submit" id="loginBtn">
                <span id="btnText">Login</span>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                </div>
            </button>
        </form>

        <div class="divider">‚Äî First time? ‚Äî</div>

        <div class="info-box">
            <strong>‚ö†Ô∏è Important:</strong> This is the Admin Panel. Only authorized administrators can access this page. If you need to create the first admin account, please contact your system administrator or use the CLI setup script.
        </div>

        <div class="links">
            <a href="../Login-system/student-login.html">Student Login</a>
            <a href="../Login-system/librarian-login.html">Librarian Login</a>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost/Library-Management-System/Back-End';

        // Check if already logged in
        window.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('user'));
            if (user && user.role === 'admin') {
                window.location.href = 'admin-dashboard.html';
            }
        });

        function showAlert(message, type = 'info') {
            const alertEl = document.getElementById('alert');
            alertEl.textContent = message;
            alertEl.className = `alert ${type}`;
        }

        async function handleLogin(event) {
            event.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const btnText = document.getElementById('btnText');
            const loading = document.getElementById('loading');

            // Disable button and show loading
            loginBtn.disabled = true;
            btnText.style.display = 'none';
            loading.style.display = 'block';

            try {
                const response = await fetch(`${API_URL}/api/auth.php?action=login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password }),
                    credentials: 'include'
                });

                const data = await response.json();

                if (data.success) {
                    // Check if user is admin
                    if (data.user.role !== 'admin') {
                        showAlert('‚úó This account is not an admin account', 'error');
                        loginBtn.disabled = false;
                        btnText.style.display = 'block';
                        loading.style.display = 'none';
                        return;
                    }

                    // Store user in localStorage
                    localStorage.setItem('user', JSON.stringify(data.user));

                    showAlert('‚úì Login successful! Redirecting...', 'info');
                    setTimeout(() => {
                        window.location.href = 'admin-dashboard.html';
                    }, 1000);
                } else {
                    showAlert(`‚úó ${data.message || 'Login failed'}`, 'error');
                    loginBtn.disabled = false;
                    btnText.style.display = 'block';
                    loading.style.display = 'none';
                }
            } catch (error) {
                showAlert(`‚úó Error: ${error.message}`, 'error');
                loginBtn.disabled = false;
                btnText.style.display = 'block';
                loading.style.display = 'none';
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
